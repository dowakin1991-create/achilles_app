import 'dart:ui';
import 'package:flutter/material.dart';
import 'settings_screen.dart';
import 'food_diary_screen.dart';
import 'profile_screen.dart'; // –ü—ñ–¥–∫–ª—é—á–∏–ª–∏ –µ–∫—Ä–∞–Ω –ø—Ä–æ—Ñ—ñ–ª—é

class MainMenuScreen extends StatelessWidget {
  const MainMenuScreen({super.key});

  @override
  Widget build(BuildContext context) {
    bool isDark = Theme.of(context).brightness == Brightness.dark;
    
    return Scaffold(
      body: Stack(
        children: [
          Container(
            decoration: BoxDecoration(
              gradient: LinearGradient(
                colors: isDark 
                    ? [Colors.black, const Color(0xFF1A1A00)] 
                    : [Colors.white, const Color(0xFFFFF9E6)],
                begin: Alignment.topLeft,
                end: Alignment.bottomRight,
              ),
            ),
          ),
          
          SafeArea(
            child: SingleChildScrollView(
              padding: const EdgeInsets.all(24.0),
              child: Column(
                crossAxisAlignment: CrossAxisAlignment.start,
                children: [
                  const SizedBox(height: 20),
                  Text(
                    'ACHILLES',
                    style: TextStyle(
                      fontSize: 42,
                      fontWeight: FontWeight.bold,
                      letterSpacing: 2,
                      color: isDark ? const Color(0xFFFFD700) : const Color(0xFFB8860B),
                    ),
                  ),
                  const SizedBox(height: 10),
                  Text(
                    '–°—Ç–∞–Ω—å –ª–µ–≥–µ–Ω–¥–æ—é.',
                    style: TextStyle(fontSize: 18, color: isDark ? Colors.white70 : Colors.black54),
                  ),
                  const SizedBox(height: 40),
                  
                  // –ö–Ω–æ–ø–∫–∏ –º–µ–Ω—é
                  _buildGlassMenuCard(
                    context: context,
                    icon: Icons.person_outline,
                    title: '–ú—ñ–π –ø—Ä–æ—Ñ—ñ–ª—å',
                    isDark: isDark,
                    onTap: () {
                      Navigator.push(context, MaterialPageRoute(builder: (context) => const ProfileScreen()));
                    }, 
                  ),
                  const SizedBox(height: 16),
                  _buildGlassMenuCard(
                    context: context,
                    icon: Icons.restaurant_menu,
                    title: '–©–æ–¥–µ–Ω–Ω–∏–∫ —ó–∂—ñ',
                    isDark: isDark,
                    onTap: () {
                      Navigator.push(context, MaterialPageRoute(builder: (context) => const FoodDiaryScreen()));
                    }, 
                  ),
                  const SizedBox(height: 16),
                  _buildGlassMenuCard(
                    context: context,
                    icon: Icons.settings_outlined,
                    title: '–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è',
                    isDark: isDark,
                    onTap: () {
                      Navigator.push(context, MaterialPageRoute(builder: (context) => const SettingsScreen()));
                    }, 
                  ),
                  const SizedBox(height: 16),
                  _buildGlassMenuCard(
                    context: context,
                    icon: Icons.info_outline,
                    title: '–ü—Ä–æ Achilles',
                    isDark: isDark,
                    onTap: () => _showAboutDialog(context, isDark),
                  ),
                ],
              ),
            ),
          ),
        ],
      ),
    );
  }

  Widget _buildGlassMenuCard({
    required BuildContext context, required IconData icon, required String title, required bool isDark, required VoidCallback onTap,
  }) {
    return GestureDetector(
      onTap: onTap,
      child: ClipRRect(
        borderRadius: BorderRadius.circular(24),
        child: BackdropFilter(
          filter: ImageFilter.blur(sigmaX: 15, sigmaY: 15),
          child: Container(
            padding: const EdgeInsets.symmetric(vertical: 20, horizontal: 24),
            decoration: BoxDecoration(
              color: isDark ? Colors.white.withOpacity(0.05) : Colors.white.withOpacity(0.4),
              borderRadius: BorderRadius.circular(24),
              border: Border.all(color: isDark ? Colors.white.withOpacity(0.1) : Colors.white.withOpacity(0.5), width: 1.5),
            ),
            child: Row(
              children: [
                Icon(icon, size: 28, color: isDark ? Colors.white : Colors.black87),
                const SizedBox(width: 20),
                Text(title, style: TextStyle(fontSize: 20, fontWeight: FontWeight.w500, color: isDark ? Colors.white : Colors.black87)),
                const Spacer(),
                Icon(Icons.arrow_forward_ios, size: 18, color: isDark ? Colors.white54 : Colors.black54),
              ],
            ),
          ),
        ),
      ),
    );
  }

  void _showAboutDialog(BuildContext context, bool isDark) {
    showDialog(
      context: context,
      builder: (BuildContext context) {
        return AlertDialog(
          backgroundColor: isDark ? const Color(0xFF1E1E1E) : Colors.white,
          shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(24)),
          title: Row(
            children: [
              Icon(Icons.shield, color: isDark ? const Color(0xFFFFD700) : const Color(0xFFB8860B)),
              const SizedBox(width: 10),
              Text('–ü—Ä–æ ACHILLES', style: TextStyle(color: isDark ? Colors.white : Colors.black)),
            ],
          ),
          content: SingleChildScrollView(
            child: Column(
              crossAxisAlignment: CrossAxisAlignment.start,
              mainAxisSize: MainAxisSize.min,
              children: [
                _buildInfoRow('üéØ', '–ú—ñ—Å—ñ—è', '–î–æ–ø–æ–º–æ–≥—Ç–∏ —Ç–æ–±—ñ —Å—Ç–∞—Ç–∏ –ª–µ–≥–µ–Ω–¥–æ—é, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ –≤–ª—ñ–∑—Ç–∏ –≤ —Ç—ñ —Å—Ç–∞—Ä—ñ –¥–∂–∏–Ω—Å–∏. –ë–æ–≥–∏ –û–ª—ñ–º–ø—É –∑–∞–∑–¥—Ä–∏—Ç–∏–º—É—Ç—å —Ç–≤–æ—ó–π –¥–∏—Å—Ü–∏–ø–ª—ñ–Ω—ñ.', isDark),
                const SizedBox(height: 16),
                _buildInfoRow('üî•', '–†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫', '–¢–æ—á–Ω—ñ –∞–ª–≥–æ—Ä–∏—Ç–º–∏. –ú–∏ –∑–Ω–∞—î–º–æ –ø—Ä–æ —Ç—É —Ü—É–∫–µ—Ä–∫—É "–¥–æ –∫–∞–≤–∏", —Ç–æ–∂ –∫—Ä–∞—â–µ –∑–∞–ø–∏—Å—É–π –≤—Å–µ —á–µ—Å–Ω–æ.', isDark),
                const SizedBox(height: 16),
                _buildInfoRow('ü•ó', '–•–∞—Ä—á—É–≤–∞–Ω–Ω—è', '–ì—Ä–µ—á–∫–∞ ‚Äî —Ü–µ —Å–∏–ª–∞, –∞–ª–µ –º–∏ –ø—ñ–¥–±–µ—Ä–µ–º–æ —Ä–µ—Ü–µ–ø—Ç–∏, —â–æ–± —Ç–∏ –Ω–µ –∑–Ω–µ–Ω–∞–≤–∏–¥—ñ–≤ —ó–∂—É –Ω–∞ —à–ª—è—Ö—É –¥–æ —Ü—ñ–ª—ñ.', isDark),
                const SizedBox(height: 16),
                _buildInfoRow('üìä', '–°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è', '–Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ –≥–æ–¥–∏–Ω–Ω–∏–∫–∞–º–∏. –¢–∏ —Å–ø–∏—à ‚Äî –º–∏ –∞–Ω–∞–ª—ñ–∑—É—î–º–æ. –¢–∏ –±—ñ–∂–∏—à ‚Äî –º–∏ —Ä–∞—Ö—É—î–º–æ.', isDark),
              ],
            ),
          ),
          actions: [
            TextButton(
              onPressed: () => Navigator.of(context).pop(),
              child: Text('–ó—Ä–æ–∑—É–º—ñ–ª–æ, –¥–æ –±–æ—é!', style: TextStyle(color: isDark ? const Color(0xFFFFD700) : const Color(0xFFB8860B))),
            ),
          ],
        );
      },
    );
  }

  Widget _buildInfoRow(String emoji, String title, String text, bool isDark) {
    return Column(
      crossAxisAlignment: CrossAxisAlignment.start,
      children: [
        Text('$emoji $title', style: TextStyle(fontWeight: FontWeight.bold, fontSize: 16, color: isDark ? Colors.white : Colors.black)),
        const SizedBox(height: 4),
        Text(text, style: TextStyle(fontSize: 14, color: isDark ? Colors.white70 : Colors.black87)),
      ],
    );
  }
}
